<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/styles.css">
    <title>時間管理 - LUM ZenMind</title>
</head>
<body>
    <div class="date-nav">
        <div class="date-selector">2025年5月12日 星期一</div>
        <div class="date-arrows">
            <span>←</span>
            <span>→</span>
        </div>
    </div>

    <div class="timeline" id="timeline">
        <!-- 動態生成的時間線 -->
    </div>

    <button onclick="openModal()">新增任務</button>

    <!-- Modal for Task Creation -->
    <div id="taskModal" style="display:none">
        <h3>新增任務</h3>
        <input type="text" id="taskName" placeholder="任務名稱">
        <input type="text" id="taskTime" placeholder="時間 (例如：14:00)">
        <textarea id="taskDesc" placeholder="描述"></textarea>
        <button onclick="addTask()">確定新增</button>
        <button onclick="closeModal()">取消</button>
    </div>

    <script>
        function openModal() {
            document.getElementById('taskModal').style.display = 'block';
        }
        function closeModal() {
            document.getElementById('taskModal').style.display = 'none';
        }
        function addTask() {
            const name = document.getElementById('taskName').value;
            const time = document.getElementById('taskTime').value;
            const desc = document.getElementById('taskDesc').value;

            const timeline = document.getElementById('timeline');
            const newTask = document.createElement('div');
            newTask.classList.add('timeline-item');
            newTask.innerHTML = `
                <div class='timeline-card'>
                    <div class='timeline-time'>${time}</div>
                    <div class='timeline-title'>${name}</div>
                    <div class='timeline-desc'>${desc}</div>
                </div>`;
            timeline.appendChild(newTask);
            closeModal();
            scheduleNotification(name, time);
        }

        function scheduleNotification(name, time) {
            const [hour, minute] = time.split(':').map(Number);
            const now = new Date();
            const target = new Date();
            target.setHours(hour);
            target.setMinutes(minute);
            target.setSeconds(0);

            const delay = target - now;

            if (delay > 0) {
                setTimeout(() => {
                    alert(`該開始「${name}」了！`);
                }, delay);
            }
        }
    </script>
</body>
</html>